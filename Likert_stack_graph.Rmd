---
title: "using likert"
author: "Doris Amoakohene"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
# Load necessary libraries
library(data.table)
library(likert)
library(ggplot2) # Ensure ggplot2 is loaded for theme adjustments

# Load the data
FSE_DATA <- fread("FSE_DATA.csv")
data_p <- FSE_DATA[-1, 6:22] # Adjust columns as needed
data_counts <- apply(data_p, 2, as.numeric)

# Convert your matrix `data_counts` to a data.table and then to a data frame for compatibility with likert
data_counts <- as.data.table(data_counts)
data_counts <- as.data.frame(data_counts)

# Define the response mapping
responses <- c("5" = "Strongly agree", 
               "4" = "Somewhat agree", 
               "3" = "Neither agree nor disagree", 
               "2" = "Somewhat disagree", 
               "1" = "Strongly disagree")

# Select the columns to generate the chart
columns <- colnames(data_counts)
filtered_counts <- data_counts[columns]

# Map numeric responses to labeled categories and ensure proper factor levels
for (i in seq_along(filtered_counts)) {
  filtered_counts[, i] <- factor(responses[as.character(filtered_counts[, i])], 
                                 levels = c("Strongly disagree", "Somewhat disagree", 
                                            "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
}

# Create a likert object
x_counts <- likert(filtered_counts)

# Generate a Likert chart and save it as a PDF (with a white background)
pdf("survey-likert-counts-white.pdf", width = 12, height = 6)
likert.bar.plot(x_counts, centered = FALSE, include.n = TRUE, 
                group.order = x_counts$results$Item, legend.position = "right") +
  theme_minimal() +  # Ensures a minimal white background
  theme(
    panel.background = element_rect(fill = "white", color = NA),
    plot.background = element_rect(fill = "white", color = NA),
    text = element_text(size = 12),
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1)
  ) +
  ggtitle("Likert Chart with Counts for Data.Table Governance Responses ")
dev.off()

```






```{r}
# Load necessary libraries
library(likert)
library(ggplot2)
library(data.table)

FSE_DATA <- fread("DATA_FSE.csv")
#data_p <- FSE_DATA[-1, 8:(ncol(FSE_DATA)-2)]
data_p <- FSE_DATA[-1, 6:22]
data <- apply(data_p, 2, as.numeric)

# Convert your matrix `data` to a data.table and then to a data frame for compatibility with likert
data <- as.data.table(data)
data <- as.data.frame(data)
```

```{r}
# Rename columns to represent questions
colnames(data) <- c("Q9", "Q10", "Q11", "Q12", "Q14", "Q15", "Q16", "Q17", "Q18", "Q19", "Q20", "Q21", "Q22", "Q23", "Q24", "Q25", "Q28")

# Define the response mapping
responses <- c("5" = "Strongly agree", 
               "4" = "Somewhat agree", 
               "3" = "Neither agree nor disagree", 
               "2" = "Somewhat disagree", 
               "1" = "Strongly disagree")

# Select the columns to generate the chart (Q9 to Q22)
columns <- c("Q9", "Q10", "Q11", "Q12", "Q14", "Q15", "Q16", "Q17", "Q18", "Q19", "Q20", "Q21", "Q22","Q23", "Q24", "Q25", "Q28")
filtered <- data[columns]

# Map numeric responses to labeled categories and ensure proper factor levels
for (i in seq_along(filtered)) {
  filtered[, i] <- factor(responses[as.character(filtered[, i])], 
                          levels = c("Strongly disagree", "Somewhat disagree", 
                                     "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
}

# Create a likert object
x <- likert(filtered)

# Generate a Likert chart and save it as a PDF
pdf("survey-likert-for_Data.Table_Governance_Responses.pdf", width = 12, height = 6)
likert.bar.plot(x, centered = TRUE, group.order = x$results$Item, legend.position = "right") +
  theme(
    text = element_text(size = 12),
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1)
  ) +
  ggtitle("Likert Chart for Data.Table Governance Responses")
dev.off()

```



```{r}
# Load necessary libraries
library(likert)
library(ggplot2)

# Rename columns to represent questions
colnames(data) <- c("Q9", "Q10", "Q11", "Q12", "Q14", "Q15", "Q16", "Q17", "Q18", "Q19", "Q20", "Q21", "Q22", "Q23", "Q24", "Q25", "Q28")

# Define the response mapping
responses <- c("5" = "Strongly agree", 
               "4" = "Somewhat agree", 
               "3" = "Neither agree nor disagree", 
               "2" = "Somewhat disagree", 
               "1" = "Strongly disagree")

# Select the columns to generate the chart (Q9 to Q22)
columns <- c("Q9", "Q10", "Q11", "Q12", "Q14", "Q15", "Q16", "Q17", "Q18", "Q19", "Q20", "Q21", "Q22", "Q23", "Q24", "Q25", "Q28")
filtered <- data[columns]

# Map numeric responses to labeled categories and ensure proper factor levels
for (i in seq_along(filtered)) {
  filtered[, i] <- factor(responses[as.character(filtered[, i])], 
                          levels = c("Strongly disagree", "Somewhat disagree", 
                                     "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
}

# Create a likert object
x <- likert(filtered)

# Generate a Likert chart and save it as a PDF
pdf("survey-likert-no-numbers.pdf", width = 12, height = 6)
likert.bar.plot(x, centered = TRUE, group.order = x$results$Item, legend.position = "right") +
  ggtitle("Likert Chart for Data.Table Governance Responses") +
  theme(
    axis.title.x = element_blank(), # Remove x-axis title
    axis.title.y = element_blank(), # Remove y-axis title
    axis.text.x = element_blank(),  # Remove x-axis numbers
    axis.text.y = element_blank(),  # Remove y-axis labels
    axis.ticks = element_blank(),   # Remove axis ticks
    legend.position = "right",      # Keep the legend
    text = element_text(size = 12)  # Set font size for the chart
  )
dev.off()

```

```{r}

FSE_DATA <- fread("FSE_DATA.csv")

# Select Q4 (Gender) and Q6 (Involvement Duration)
data_selected <- FSE_DATA[, .(Gender = Q4, Duration = Q6)]

# Convert to factors with appropriate levels
data_selected$Gender <- factor(data_selected$Gender, levels = c("Man", "Woman"))
data_selected$Duration <- factor(data_selected$Duration, levels = c(
  "less than 1", "0", "1", "2-3", "4", "5", "10", "12", "Approximately a decade"
))

# Aggregate data for counts
gender_counts <- as.data.frame(table(data_selected$Gender))
duration_counts <- as.data.frame(table(data_selected$Duration))

# Save the Gender Bar Chart as PNG
png("survey_responses_by_gender.png", width = 800, height = 600)
ggplot(gender_counts, aes(x = Var1, y = Freq, fill = Var1)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Survey Responses by Gender",
    x = "Gender",
    y = "Count",
    fill = "Gender"
  ) +
  theme_minimal()
dev.off()
```


```{r}
# Save the Duration Bar Chart as PNG
png("survey_responses_by_duration.png", width = 800, height = 600)
ggplot(duration_counts, aes(x = Var1, y = Freq, fill = Var1)) +
  geom_bar(stat = "identity") +
  labs(
    title = "Survey Responses by Duration of Involvement",
    x = "Duration (Years)",
    y = "Count",
    fill = "Duration"
  ) +
  theme_minimal()
dev.off()


```




counts


```{r}
# Load necessary libraries
library(likert)

# Load the data
FSE_DATA <- fread("FSE_DATA.csv")
data_p <- FSE_DATA[-1, 6:22] # Adjust columns as needed
data_counts <- apply(data_p, 2, as.numeric)

# Convert your matrix `data_counts` to a data.table and then to a data frame for compatibility with likert
data_counts <- as.data.table(data_counts)
data_counts <- as.data.frame(data_counts)

# Define the response mapping
responses <- c("5" = "Strongly agree", 
               "4" = "Somewhat agree", 
               "3" = "Neither agree nor disagree", 
               "2" = "Somewhat disagree", 
               "1" = "Strongly disagree")

# Select the columns to generate the chart
columns <- colnames(data_counts)
filtered_counts <- data_counts[columns]

# Map numeric responses to labeled categories and ensure proper factor levels
for (i in seq_along(filtered_counts)) {
  filtered_counts[, i] <- factor(responses[as.character(filtered_counts[, i])], 
                                 levels = c("Strongly disagree", "Somewhat disagree", 
                                            "Neither agree nor disagree", "Somewhat agree", "Strongly agree"))
}

# Create a likert object
x_counts <- likert(filtered_counts)

# Generate a Likert chart and save it as a PDF (with raw counts)
pdf("survey-likert-counts.pdf", width = 12, height = 6)
likert.bar.plot(x_counts, centered = FALSE, include.n = TRUE, group.order = x_counts$results$Item, legend.position = "right") +
  theme(
    text = element_text(size = 12),
    axis.title.x = element_blank(),
    axis.text.x = element_text(size = 10, angle = 45, hjust = 1)
  ) +
  ggtitle("Likert Chart with Counts for Data.Table Governance Responses")
dev.off()

```


